sort TComm = struct undetected | detected | unpressed | pressed;

act
	s1, r1, c1, r2, s2, c2: TComm;
	moving, stop, detect, press;

proc
	M = r1(undetected).r2(pressed).moving.M + (r1(detected)+r2(unpressed)).stop.M;
	S1 = s1(undetected).S1 + detect.s1(detected).S1;
	B1 = s2(unpressed).B1 + press.B2;
	B2 = s2(pressed).B1;

init
	allow({ c1, c2, moving, stop, detect, press },
		comm(
			{
				s1|r1 -> c1,
				s2|r2 -> c2
			},
			M || S1 || B1 || B2
		)
	);