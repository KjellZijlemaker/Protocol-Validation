sort TComm = struct undetected | detectedupper | detectedlower | detectedrightmost | detectedleftmost | unpressed | pressed;

act
	s1, r1, c1, r2, s2, c2: TComm;
	moving, stop, detect, press;
	enablebrake, releasebrake;

proc
	M = r1(undetected).r2(pressed).releasebrake.moving.M + (r1(detectedupper) + r1(detectedlower)+r2(unpressed)).enablebrake.stop.M;
	S1 = s1(undetected).S1 + detect.(s1(detectedupper) + s1(detectedlower) + s1(detectedleftmost) + s1(detectedrightmost)).S1;
	B1 = s2(unpressed).B1 + press.B2;
	B2 = s2(pressed).B1;

	M2 = r1(undetected).r2(pressed).releasebrake.moving.M2 + (r1(detectedleftmost) + r1(detectedrightmost)+r2(unpressed)).enablebrake.stop.M2;
init
	allow({ c1, c2, moving, stop, detect, press, enablebrake,releasebrake},
		comm(
			{
				s1|r1 -> c1,
				s2|r2 -> c2
			},
			M || M2 || S1 || B1 || B2
		)
	);